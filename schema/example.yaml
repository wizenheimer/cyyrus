spec: v0 # Version of the schema

# Define the properties of the dataset
dataset:
  # Define the metadata of the dataset
  metadata:
    name: invoice dataset # Name of the dataset
    description: Dataset containing the invoice data # Description of the dataset
    tags: [invoice, document] # Tags of the dataset
    license: CC-BY-NC-SA # License of the dataset
    language: en # Language of the dataset

  # Define how to shuffle the dataset
  shuffle:
    seed: 42

  # Define the splits of the dataset
  splits:
    train: 0.8 # The sum of all splits should be 1, if not specified the remaining data will be used for training. Could be named train, training
    test: 0.2 # The sum of all splits should be 1, if not specified the remaining data will be used for training. Could be named test, testing, eval, evaluation
    seed: 42 # Seed for the split

  # Define the attributes of the dataset
  attributes:
    required_columns: [
        invoice,
        document_id,
        invoice_items,
        document_info,
        invoice_questions,
      ] # List of required columns. If any of these columns are missing, the dataset will not be generated
    unique_columns: [document_id] # If there are any unique columns, specify them here. Non unique columns will be removed from the dataset
    nulls: include # Whether or not to include null values in the dataset, include, exclude, special_token

# Define the types that will be used in the dataset
types:
  invoice_data:
    type: object
    properties: # Incase of object type, must define the properties of the object
      invoice_id:
        type: string
      invoice_date:
        type: string
      invoice_items:
        type: array
        items:
          type: object
          properties:
            item: string
            category: string
            sub_category: string
            description: string
            price: float
            quantity: integer

  invoice_questions:
    type: array
    items:
      type: object
      properties:
        question: string
        answer: string

# Define the tasks that will be used in Dataset generation, and their properties
tasks:
  invoice_parsing:
    task_type: document_parsing
    task_properties:
      directory: /path/to/invoices
      file_type: pdf
      max_depth: 5
      response_format: base64 # image, base64, or text

  extract_invoice_data:
    task_type: generation
    task_properties:
      max_tokens: 100
      model: gpt-3.5-turbo
      prompt: Extract the invoice data from the document {invoice}
      response_format: invoice_data

  generate_invoice_questions:
    task_type: generation
    task_properties:
      max_tokens: 100
      model: gpt-3.5-turbo
      prompt: Generate questions about the invoice items {invoice_questions}
      response_format: invoice_questions

# Define the columns that will be used in the dataset
columns:
  invoice:
    task_id: invoice_parsing

  invoice_data:
    task_id: extract_invoice_data
    task_input: [invoice]

  invoice_questions:
    task_id: generate_invoice_questions
    task_input: [invoice_data]
